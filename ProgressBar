public class ProgressBar {
    // --- Parámetros de ubicación y tamaño por defecto ---
    private static final int DEFAULT_X = 20;    // Más a la izquierda (ajusta si lo quieres más a la derecha)
    private static final int DEFAULT_Y = 160;   // MÁS ABAJO (ajusta este valor para moverla verticalmente)
    private static final int DEFAULT_WIDTH = 50; // Ancho de la barra
    private static final int DEFAULT_HEIGHT = 500; // Alto total

    private Rectangle bgBar;      // Fondo de la barra
    private Rectangle bar;        // Barra de progreso (ganancia)
    private int x, y;             // Esquina superior izquierda
    private int width, height;    // Dimensiones
    private int currentProfit;    // Ganancia actual
    private int maxProfit;        // Ganancia máxima posible
    private boolean isVisible;

    /**
     * Crea una ProgressBar vertical en posición fija y tamaño fijo.
     * No requiere parámetros.
     */
    public ProgressBar(boolean visible) {
        this.x = DEFAULT_X;
        this.y = DEFAULT_Y;
        this.width = DEFAULT_WIDTH;
        this.height = DEFAULT_HEIGHT;
        this.currentProfit = 0;
        this.maxProfit = 1; // Evita división por cero
        this.isVisible = visible;
    
        // Fondo gris
        bgBar = new Rectangle();
        bgBar.changeColor("lightgray");
        bgBar.changeSize(height, width); 
        bgBar.setPosition(x, y);
    
        // Barra verde
        bar = new Rectangle();
        bar.changeColor("green");
        bar.changeSize(0, width); 
        bar.setPosition(x, y + height);
    
        // Hacer visible solo si visible es true
        if (isVisible) {
            bgBar.makeVisible();
            bar.makeVisible();
        }
    }

    /**
     * Actualiza el progreso de la barra.
     * @param currentProfit ganancia actual (número >= 0)
     * @param maxProfit ganancia máxima posible (número > 0)
     */
    public void setProgress(int currentProfit, int maxProfit) {
        this.currentProfit = Math.max(0, currentProfit);
        this.maxProfit = Math.max(1, maxProfit); // Nunca 0
        double frac = (double)this.currentProfit / this.maxProfit;
        frac = Math.max(0.0, Math.min(1.0, frac)); // Clamp entre 0 y 1

        int progHeight = (int)(height * frac);

        // La barra debe crecer de abajo hacia arriba
        bar.changeSize(progHeight, width);
        bar.setPosition(x, y + height - progHeight);
         if (isVisible) bar.makeVisible();
        else bar.makeInvisible();
    }
    

    /**
     * Hace visible la progress bar.
     */
    public void makeVisible() {
        if (!isVisible) {
            bgBar.makeVisible();
            bar.makeVisible();
            isVisible = true;
        }
    }

    /**
     * Hace invisible la progress bar.
     */
    public void makeInvisible() {
        if (isVisible) {
            bgBar.makeInvisible();
            bar.makeInvisible();
            isVisible = false;
        }
    }
}
